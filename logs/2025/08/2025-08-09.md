# üóìÔ∏è 2025-08-09 (SAT)

> **Today I learned** How to use Python with SQLite to create, update, and query databases, including working with SQL commands inside Python scripts and DB Browser for SQLite.



## üìò Python + SQLite ‚Äì Database Integration

Studied how to integrate **SQLite** (a lightweight database) with Python using the `sqlite3` module.  
Covered:

- **Creating Tables** with `CREATE TABLE`
- **Inserting Data** with `INSERT INTO`
- **Updating Records** with `UPDATE`
- **Querying Data** with `SELECT` and filtering using `WHERE`
- **Sorting Results** with `ORDER BY`
- **Deleting Data** with `DELETE`
- Using placeholders `?` in SQL to prevent SQL injection
- Managing SQLite files using **DB Browser for SQLite**



## üí° Insight

- SQL commands in Python are **strings** executed by `cursor.execute()`.
- Placeholders (`?`) keep queries safe from injection and make code cleaner.
- `fetchone()` returns a single row or `None` if no results.
- `commit()` is essential after INSERT/UPDATE/DELETE to save changes to the `.sqlite` file.
- DB Browser for SQLite is a great GUI for checking tables and running queries interactively.



## üêç Python Practice

Created a script (`orgcount.py`) to read an email log file, extract the domain from email addresses, and count occurrences per domain.

Example:
```python
import sqlite3

conn = sqlite3.connect('orgdb.sqlite')
cur = conn.cursor()

cur.execute('DROP TABLE IF EXISTS Counts')
cur.execute('CREATE TABLE Counts (org TEXT, count INTEGER)')

fname = input('Enter file name: ')
if len(fname) < 1:
    fname = 'mbox-short.txt'

fh = open(fname)
for line in fh:
    if not line.startswith('From '):
        continue
    email = line.split()[1]
    org = email.split('@')[1]
    
    cur.execute('SELECT count FROM Counts WHERE org = ?', (org,))
    row = cur.fetchone()
    if row is None:
        cur.execute('INSERT INTO Counts (org, count) VALUES (?, 1)', (org,))
    else:
        cur.execute('UPDATE Counts SET count = count + 1 WHERE org = ?', (org,))

conn.commit()

for org, cnt in cur.execute('SELECT org, count FROM Counts ORDER BY count DESC LIMIT 10'):
    print(org, cnt)

cur.close()
```

## üìÑ Problem Summary ‚Äì Counting Email Domains
```python
# Reads mbox.txt or mbox-short.txt
# Counts number of occurrences of each domain
# Stores results in SQLite database (orgdb.sqlite)
# Outputs the top 10 domains by count
```

## üß† Concepts Practiced
- ‚úÖ Creating & Dropping Tables
- ‚úÖ Inserting and Updating rows in SQL
- ‚úÖ Querying with SELECT and filtering with WHERE
- ‚úÖ Sorting with ORDER BY
- ‚úÖ Using placeholders ? in SQL
- ‚úÖ Using Python loops to process and insert data into DBacticed

## üß† Reflection
- Writing SQL directly inside Python felt very powerful ‚Äî all database logic in one place.
- Placeholders ? are not just safer, but also make it easier to maintain and modify queries.
- Using DB Browser for SQLite to verify results was extremely helpful for debugging.
- Processing large files (like mbox.txt) can take longer, so commits and queries need to be efficient.

